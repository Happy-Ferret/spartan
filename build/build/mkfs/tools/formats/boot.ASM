 
 format binary as 'EXE'
 org    ImageBase
 use32
 
 ImageBase = 0x00400000
 
 
 mzhdr:
 .e_magic:    dw 0x5A4D
 .e_cblp:     dw 0x0040
 .e_cp:       dw 0x0009
 .e_crlc:     dw 0x0000
 .e_cparhdr:  dw 0x0004
 .e_minalloc: dw 0x0010
 .e_maxalloc: dw 0xFFFF
 .e_ss:       dw 0x0102
 .e_sp:       dw 0xFFF0
 .e_csum:     dw 0x0001
 .e_ip:       dw 0x0000
 .e_cs:       dw 0x0000
 .e_lsarlc:   dw 0x0002
 .e_ovno:     dw 0x001C
 .e_res:      dw 0x0000, 0x0000, 0x0000, 0x0000
 .e_oemid:    dw 0x0000
 .e_oeminfo:  dw 0x0000
 .e_res2:     dw 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
 .e_lfanew:   dd 0x00000088
 
 db 0x09, 0xE6, 0xFE, 0x2C, 0x4D, 0x87, 0x90, 0x7F, 0x4D, 0x87, 0x90, 0x7F, 0x4D, 0x87, 0x90, 0x7F
 db 0xF8, 0x19, 0x4D, 0x7F, 0x4E, 0x87, 0x90, 0x7F, 0x4D, 0x87, 0x91, 0x7F, 0x4C, 0x87, 0x90, 0x7F
 db 0xF8, 0x19, 0x70, 0x7F, 0x4C, 0x87, 0x90, 0x7F, 0xF8, 0x19, 0x4E, 0x7F, 0x4C, 0x87, 0x90, 0x7F
 db 0x52, 0x69, 0x63, 0x68, 0x4D, 0x87, 0x90, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 
 pehdr:
 .pesig:                dd 0x00004550
 .Machine:              dw 0x014C
 .NumberOfSections:     dw 0x0003
 .TimeDateStamp:        dd 0x59DA6B86
 .PointerToSymbolTable: dd 0x00000000
 .NumberOfSymbols:      dd 0x00000000
 .SizeOfOptionalHeader: dw 0x00E0
 .Characteristics:      dw 0x0102
 
 ophdr:
 .Magic:                       dw 0x010B
 .MajorLinkerVersion:          db 0x0C
 .MinorLinkerVersion:          db 0x00
 .SizeOfCode:                  dd 0x00000020
 .SizeOfInitializedData:       dd 0x00000080
 .SizeOfUninitializedData:     dd 0x00000000
 .AddressOfEntryPoint:         dd 0x00000200
 .BaseOfCode:                  dd 0x00000200
 .BaseOfData:                  dd 0x00000220
 .ImageBase:                   dd 0x00400000
 .SectionAlignment:            dd 0x00000020
 .FileAlignment:               dd 0x00000020
 .MajorOperatingSystemVersion: dw 0x0006
 .MinorOperatingSystemVersion: dw 0x0000
 .MajorImageVersion:           dw 0x0000
 .MinorImageVersion:           dw 0x0000
 .MajorSubsystemVersion:       dw 0x0006
 .MinorSubsystemVersion:       dw 0x0000
 .Win32VersionValue:           dd 0x00000000
 .SizeOfImage:                 dd 0x000002A0
 .SizeOfHeaders:               dd 0x00000200
 .CheckSum:                    dd 0x00000000
 .Subsystem:                   dw 0x0003
 .DllCharacteristics:          dw 0x8040
 .SizeOfStackReserve:          dd 0x00100000
 .SizeOfStackCommit:           dd 0x00001000
 .SizeOfHeapReserve:           dd 0x00100000
 .SizeOfHeapCommit:            dd 0x00001000
 .LoaderFlags:                 dd 0x00000000
 .NumberOfRvaAndSizes:         dd 0x00000010
 
 datadir:
 .Export.Address:                dd 0x00000000
 .Export.Size:                   dd 0x00000000
 .Import.Address:                dd 0x00000228
 .Import.Size:                   dd 0x00000028
 .Resource.Address:              dd 0x00000000
 .Resource.Size:                 dd 0x00000000
 .Exception.Address:             dd 0x00000000
 .Exception.Size:                dd 0x00000000
 .Certificate.Address:           dd 0x00000000
 .Certificate.Size:              dd 0x00000000
 .Relocation.Address:            dd 0x00000280
 .Relocation.Size:               dd 0x0000000C
 .Debugging.Address:             dd 0x00000000
 .Debugging.Size:                dd 0x00000000
 .Architecture.Address:          dd 0x00000000
 .Architecture.Size:             dd 0x00000000
 .GlobalPointerRegister.Address: dd 0x00000000
 .GlobalPointerRegister.Size:    dd 0x00000000
 .ThreadLocalStorage.Address:    dd 0x00000000
 .ThreadLocalStorage.Size:       dd 0x00000000
 .LoadConfiguration.Address:     dd 0x00000000
 .LoadConfiguration.Size:        dd 0x00000000
 .BoundImport.Address:           dd 0x00000000
 .BoundImport.Size:              dd 0x00000000
 .ImportAddress.Address:         dd 0x00000220
 .ImportAddress.Size:            dd 0x00000008
 .DelayImport.Address:           dd 0x00000000
 .DelayImport.Size:              dd 0x00000000
 .CLR.Address:                   dd 0x00000000
 .CLR.Size:                      dd 0x00000000
 .Reserve.Address:               dd 0x00000000
 .Reserve.Size:                  dd 0x00000000
 
 textsect:
 .Name:                 db 0x2E, 0x74, 0x65, 0x78, 0x74, 0x00, 0x00, 0x00 ; '.text'
 .VirtualSize:          dd 0x0000000E
 .VirtualAddress:       dd 0x00000200
 .SizeOfRawData:        dd 0x00000020
 .PointerToRawData:     dd 0x00000200
 .PointerToRelocations: dd 0x00000000
 .PointerToLinenumbers: dd 0x00000000
 .NumberOfRelocations:  dw 0x0000
 .NumberOfLinenumbers:  dw 0x0000
 .Characteristics:      dd 0x60000020
 
 rdatasect:
 .Name:                 db 0x2E, 0x72, 0x64, 0x61, 0x74, 0x61, 0x00, 0x00 ; '.rdata'
 .VirtualSize:          dd 0x0000004E
 .VirtualAddress:       dd 0x00000220
 .SizeOfRawData:        dd 0x00000060
 .PointerToRawData:     dd 0x00000220
 .PointerToRelocations: dd 0x00000000
 .PointerToLinenumbers: dd 0x00000000
 .NumberOfRelocations:  dw 0x0000
 .NumberOfLinenumbers:  dw 0x0000
 .Characteristics:      dd 0x40000040
 
 relocsect:
 .Name:                 db 0x2E, 0x72, 0x65, 0x6C, 0x6F, 0x63, 0x00, 0x00 ; '.reloc'
 .VirtualSize:          dd 0x0000000C
 .VirtualAddress:       dd 0x00000280
 .SizeOfRawData:        dd 0x00000020
 .PointerToRawData:     dd 0x00000280
 .PointerToRelocations: dd 0x00000000
 .PointerToLinenumbers: dd 0x00000000
 .NumberOfRelocations:  dw 0x0000
 .NumberOfLinenumbers:  dw 0x0000
 .Characteristics:      dd 0x42000040
 
 db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 db 0xE8, 0x03, 0x00, 0x00, 0x00, 0xEB, 0xF9, 0xCC, 0xFF, 0x25, 0x20, 0x02, 0x40, 0x00, 0x00, 0x00
 db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 
 
 ImportAddressTable:
 dd 0x00000258
 dd 0x00000000
 
 
 ImportTable:
 dd 0x00000250, 0x00000000, 0x00000000, 0x00000262, 0x00000220
 dd 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
 
 
 OriginalImportAddressTable:
 dd 0x00000258
 dd 0x00000000
 dw 0x0000
 db 'kernel',0,0
 db 'kernel.dll',0,0
 
 db 0x00, 0x00
 db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 db 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x0A, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
 db 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
